{"version":3,"file":"firebase_object_factory.js","sourceRoot":"","sources":["../../../src/database-deprecated/firebase_object_factory.ts"],"names":[],"mappings":"AAAA,OAAO,EAAC,MAAM,EAAC,MAAM,eAAe,CAAC;AACrC,OAAO,EAAC,wBAAwB,EAAC,MAAM,8BAA8B,CAAC;AACtE,OAAO,EAAC,qBAAqB,EAAC,MAAM,cAAc,CAAC;AAEnD,OAAO,EAAC,SAAS,EAAC,MAAM,gBAAgB,CAAC;AACzC,OAAO,KAAK,KAAK,MAAM,SAAS,CAAC;AAGjC,MAAM,gCACJ,GAAsB,EACtB,EAAkD;QAAjD,6DAAgB;IAEjB,IAAM,gBAAgB,GAAG,IAAI,wBAAwB,CAAC,UAAC,GAAkB;QACvE,IAAI,EAAE,GAAG,GAAG,CAAC,EAAE,CACb,OAAO,EACP,UAAC,QAAsB;YACrB,GAAG,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,KAAK,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC;QACtE,CAAC,EACD,UAAA,GAAG;YACD,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;gBACR,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBACf,GAAG,CAAC,QAAQ,EAAE,CAAC;YACjB,CAAC;QACH,CAAC,CACF,CAAC;QAEF,MAAM,CAAC,cAAM,OAAA,GAAG,CAAC,GAAG,CAAC,OAAO,EAAE,EAAE,CAAC,EAApB,CAAoB,CAAC;IACpC,CAAC,EAAE,GAAG,CAAC,CAAC;IAMR,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAC1B,SAAS,CAAC,IAAI,qBAAqB,CAAC,IAAI,MAAM,CAAC,EAAE,CAAC,EAAE,EAAE,CAAQ,CAAC,CAC/B,CAAC;AACrC,CAAC","sourcesContent":["import {NgZone} from \"@angular/core\";\nimport {FirebaseObjectObservable} from \"./firebase_object_observable\";\nimport {FirebaseZoneScheduler} from \"angularfire2\";\nimport {Observer} from \"rxjs\";\nimport {observeOn} from \"rxjs/operators\";\nimport * as utils from \"./utils\";\nimport {DataSnapshot, FirebaseObjectFactoryOpts, DatabaseReference} from \"./interfaces\";\n\nexport function FirebaseObjectFactory(\n  ref: DatabaseReference,\n  {preserveSnapshot}: FirebaseObjectFactoryOpts = {}\n): FirebaseObjectObservable<any> {\n  const objectObservable = new FirebaseObjectObservable((obs: Observer<any>) => {\n    let fn = ref.on(\n      \"value\",\n      (snapshot: DataSnapshot) => {\n        obs.next(preserveSnapshot ? snapshot : utils.unwrapMapFn(snapshot));\n      },\n      err => {\n        if (err) {\n          obs.error(err);\n          obs.complete();\n        }\n      }\n    );\n\n    return () => ref.off(\"value\", fn);\n  }, ref);\n\n  // TODO: should be in the subscription zone instead\n  // RTM: 2018-07-19\n  // REPALCE THIS BUGGY CODE\n  // return observeOn.call(objectObservable, new FirebaseZoneScheduler(new NgZone({}), {}));\n  return objectObservable.pipe(\n    observeOn(new FirebaseZoneScheduler(new NgZone({}), {}) as any)\n  ) as FirebaseObjectObservable<any>;\n}\n"]}